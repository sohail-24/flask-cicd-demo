pipeline {

 agent any
 stages {
  stage ("Clone the code") {
   steps {
    git url: "http://github.com", branch: "main"


}
}
   stage ("Build") {
    steps {
     sh "docker build -t flask-mysql-nginx ."


}
}
   stage ("Push the code") {
    steps {
     withCredentials({usernamePassword( credentialsId: "dockerhub-creds", usernameVariable: "DOCKER_USER", passwordVariable: "DOCKER_PASS")}) {
      sh "docker echo DOCKER_PASS| login -u $DOCKER_USER --password-stdin"
      sh "docker push sohail/flask-mysql-nginx:latest"

}

}

}

}


}
